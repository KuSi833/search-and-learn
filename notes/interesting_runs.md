Index: 9
Ground Truth: 4
── Approach: best_of_n — n=32, temp=0.7, top_p=0.8, max_tokens=2048, agg=prod ──
Adding requests: 100%|██████████| 32/32 [00:00<00:00, 1754.96it/s]
Processed prompts: 0%| | 0/32 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, outputProcessed prompts: 3%|▎ | 1/32 [00:34<17:50, 34.52s/it, est. speed input: 10.25 toks/Processed prompts: 100%|██████████| 32/32 [00:34<00:00, 34.52s/it, est. speed input: 327.93 tokProcessed prompts: 100%|██████████| 32/32 [00:34<00:00, 1.08s/it, est. speed input: 327.93 toks/s, output: 1897.17 toks/s]
WARNING | transformers_modules.Qwen2.5-Math-PRM-7B.modeling_qwen2_rm | We detected that you are passing `past_key_values` as a tuple and this is deprecated and will be removed in v4.43. Please use an appropriate `Cache` class (https://huggingface.co/docs/transformers/v4.41.3/en/internal/generation_utils#transformers.Cache)
Candidates  
┏━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━┓
┃ # ┃ PRM(prod) ┃ PRM(mean) ┃ PRM(last) ┃ PRM(min) ┃ Answer ┃
┡━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━┩
│ 0 │ 0.0000 │ 0.2013 │ 0.0261 │ 0.0248 │ 2 │
│ 1 │ 0.0000 │ 0.2321 │ 0.0266 │ 0.0251 │ 2 │
│ 2 │ 0.0000 │ 0.1475 │ 0.0261 │ 0.0248 │ 3 │
│ 3 │ 0.0000 │ 0.2589 │ 0.0260 │ 0.0248 │ 4 │
│ 4 │ 0.0000 │ 0.1144 │ 0.0267 │ 0.0247 │ 3 │
│ 5 │ 0.0000 │ 0.1152 │ 0.0261 │ 0.0255 │ 4 │
│ 6 │ 0.0000 │ 0.2019 │ 0.0266 │ 0.0251 │ 1 │
│ 7 │ 0.0000 │ 0.1791 │ 0.0264 │ 0.0248 │ 3 │
│ 8 │ 0.0000 │ 0.1750 │ 0.0255 │ 0.0244 │ 1 │
│ 9 │ 0.0000 │ 0.1079 │ 0.0276 │ 0.0248 │ 1 │
│ 10 │ 0.0000 │ 0.1801 │ 0.0264 │ 0.0248 │ 2 │
│ 11 │ 0.0000 │ 0.1533 │ 0.0276 │ 0.0248 │ 4 │
│ 12 │ 0.0000 │ 0.1233 │ 0.0266 │ 0.0247 │ 4 │
│ 13 │ 0.0000 │ 0.1648 │ 0.0264 │ 0.0250 │ 121 │
│ 14 │ 0.0000 │ 0.0852 │ 0.0267 │ 0.0248 │ 11 │
│ 15 │ 0.0000 │ 0.1637 │ 0.0261 │ 0.0258 │ 3 │
│ 16 │ 0.0000 │ 0.1662 │ 0.0264 │ 0.0248 │ 5 │
│ 17 │ 0.0000 │ 0.2569 │ 0.0273 │ 0.0248 │ 2 │
│ 18 │ 0.0000 │ 0.1400 │ 0.0272 │ 0.0258 │ 1 │
│ 19 │ 0.0000 │ 0.1288 │ 0.0267 │ 0.0251 │ 9 │
│ 20 │ 0.0000 │ 0.1206 │ 0.0272 │ 0.0244 │ 12 │
│ 21 │ 0.0000 │ 0.1243 │ 0.0270 │ 0.0244 │ 3 │
│ 22 │ 0.0000 │ 0.1543 │ 0.0260 │ 0.0244 │ 6 │
│ 23 │ 0.0000 │ 0.1590 │ 0.0266 │ 0.0236 │ 2 │
│ 24 │ 0.0000 │ 0.1878 │ 0.0267 │ 0.0250 │ 2 │
│ 25 │ 0.0000 │ 0.1556 │ 0.0276 │ 0.0248 │ 5 │
│ 26 │ 0.0000 │ 0.1213 │ 0.0273 │ 0.0251 │ 3 │
│ 27 │ 0.0000 │ 0.1347 │ 0.0260 │ 0.0240 │ 3 │
│ 28 │ 0.0000 │ 0.0974 │ 0.0264 │ 0.0244 │ 11 │
│ 29 │ 0.0000 │ 0.1885 │ 0.0266 │ 0.0251 │ 2 │
│ 30 │ 0.0000 │ 0.2034 │ 0.0260 │ 0.0255 │ 5 │
│ 31 │ 0.0000 │ 0.1042 │ 0.0261 │ 0.0250 │ 10 │
└────┴───────────┴───────────┴───────────┴──────────┴────────┘
Predicted: 5
Correct: False
INFO | **main** | Running approach=beam_search
─ Approach: beam_search — n=32, temp=0.7, top_p=0.8, max_tokens=2048, agg=prod ─
Beam search iterations: 50%|█████ | 20/40 [01:27<01:27, 4.38s/it]
Candidates  
┏━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━┓
┃ # ┃ PRM(prod) ┃ PRM(mean) ┃ PRM(last) ┃ PRM(min) ┃ Answer ┃
┡━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━┩
│ 0 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 1 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 2 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 3 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 4 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 5 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 6 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 7 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 8 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 9 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 10 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 11 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 12 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 13 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 14 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 15 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 16 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 17 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 18 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 19 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 20 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 21 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 22 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 23 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 24 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 25 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 26 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 27 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 28 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 29 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 30 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
│ 31 │ 0.9136 │ 0.9957 │ 1.0000 │ 0.9766 │ 4 │
└────┴───────────┴───────────┴───────────┴──────────┴────────┘
Predicted: 4
Correct: True
